# ============================================================================
# Sullivan Services Configuration (Proxied via Tailscale)
# ============================================================================
# Reverse proxy configuration for services running on Sullivan server.
# All traffic is proxied from Freddy to Sullivan over Tailscale network.
#
# Media Services:
#   - Emby (emby.7gram.xyz)
#   - Jellyfin (jellyfin.7gram.xyz)
#   - Plex (plex.7gram.xyz)
#
# Download/Automation:
#   - Sonarr (sonarr.7gram.xyz)
#   - Radarr (radarr.7gram.xyz)
#   - Lidarr (lidarr.7gram.xyz)
#   - Prowlarr (prowlarr.7gram.xyz)
#   - Bazarr (bazarr.7gram.xyz)
#   - qBittorrent (qbt.7gram.xyz)
#
# Media Requests & Processing:
#   - Overseerr (overseerr.7gram.xyz)
#   - Tdarr (tdarr.7gram.xyz)
#
# Books/Media:
#   - Calibre (calibre.7gram.xyz)
#   - YouTube-DL (yt.7gram.xyz)
#   - FileBot (filebot.7gram.xyz)
#
# Utilities:
#   - Grocy (grocy.7gram.xyz)
#   - Mealie (mealie.7gram.xyz)
#   - Wiki.js (wiki.7gram.xyz)
#   - Duplicati (duplicati.7gram.xyz)
#
# NOTE: All proxy_pass directives use variables to enable runtime DNS
# resolution. This allows nginx to start even when backend services are
# unavailable. The resolver directive in nginx.conf is required.
# ============================================================================

# =============================================================================
# MEDIA SERVERS
# =============================================================================

# Emby - Media Server
server {
    listen 443 ssl;
    http2 on;
    listen [::]:443 ssl;
    server_name emby.7gram.xyz;

    ssl_certificate /etc/nginx/ssl/fullchain.pem;
    ssl_certificate_key /etc/nginx/ssl/privkey.pem;

    # Security headers
    add_header Strict-Transport-Security "max-age=31536000; includeSubDomains" always;
    add_header X-Frame-Options "SAMEORIGIN" always;
    add_header X-Content-Type-Options "nosniff" always;

    # Large body size for uploads
    client_max_body_size 100M;

    location / {
        # Using variable for runtime DNS resolution
        set $upstream_emby $sullivan_emby_upstream;
        proxy_pass http://$upstream_emby;
        proxy_http_version 1.1;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;

        # WebSocket support for Emby
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";

        # Streaming optimizations
        proxy_buffering off;
        proxy_read_timeout 86400s;
        proxy_send_timeout 86400s;
    }

    # Emby WebSocket
    location /embywebsocket {
        set $upstream_emby $sullivan_emby_upstream;
        proxy_pass http://$upstream_emby/embywebsocket;
        proxy_http_version 1.1;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";
        proxy_read_timeout 86400s;
    }
}

# Jellyfin - Media Server
server {
    listen 443 ssl;
    http2 on;
    listen [::]:443 ssl;
    server_name jellyfin.7gram.xyz;

    ssl_certificate /etc/nginx/ssl/fullchain.pem;
    ssl_certificate_key /etc/nginx/ssl/privkey.pem;

    # Security headers
    add_header Strict-Transport-Security "max-age=31536000; includeSubDomains" always;
    add_header X-Frame-Options "SAMEORIGIN" always;
    add_header X-Content-Type-Options "nosniff" always;

    # Large body size for uploads
    client_max_body_size 100M;

    location / {
        # Using variable for runtime DNS resolution
        set $upstream_jellyfin $sullivan_jellyfin_upstream;
        proxy_pass http://$upstream_jellyfin;
        proxy_http_version 1.1;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;

        # WebSocket support
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";

        # Streaming optimizations
        proxy_buffering off;
        proxy_read_timeout 86400s;
        proxy_send_timeout 86400s;
    }

    # Jellyfin WebSocket
    location /socket {
        set $upstream_jellyfin $sullivan_jellyfin_upstream;
        proxy_pass http://$upstream_jellyfin/socket;
        proxy_http_version 1.1;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";
        proxy_read_timeout 86400s;
    }
}

# Plex - Media Server
server {
    listen 443 ssl;
    http2 on;
    listen [::]:443 ssl;
    server_name plex.7gram.xyz;

    ssl_certificate /etc/nginx/ssl/fullchain.pem;
    ssl_certificate_key /etc/nginx/ssl/privkey.pem;

    # Security headers
    add_header Strict-Transport-Security "max-age=31536000; includeSubDomains" always;
    add_header X-Frame-Options "SAMEORIGIN" always;
    add_header X-Content-Type-Options "nosniff" always;

    # Plex headers
    proxy_set_header X-Plex-Client-Identifier $http_x_plex_client_identifier;
    proxy_set_header X-Plex-Device $http_x_plex_device;
    proxy_set_header X-Plex-Device-Name $http_x_plex_device_name;
    proxy_set_header X-Plex-Platform $http_x_plex_platform;
    proxy_set_header X-Plex-Platform-Version $http_x_plex_platform_version;
    proxy_set_header X-Plex-Product $http_x_plex_product;
    proxy_set_header X-Plex-Token $http_x_plex_token;
    proxy_set_header X-Plex-Version $http_x_plex_version;
    proxy_set_header X-Plex-Nocache $http_x_plex_nocache;
    proxy_set_header X-Plex-Provides $http_x_plex_provides;
    proxy_set_header X-Plex-Device-Vendor $http_x_plex_device_vendor;
    proxy_set_header X-Plex-Model $http_x_plex_model;

    # Large body size
    client_max_body_size 100M;

    location / {
        # Using variable for runtime DNS resolution
        set $upstream_plex $sullivan_plex_upstream;
        proxy_pass http://$upstream_plex;
        proxy_http_version 1.1;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;

        # WebSocket support
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";

        # Streaming optimizations
        proxy_buffering off;
        proxy_read_timeout 86400s;
        proxy_send_timeout 86400s;

        # Plex specific
        proxy_redirect off;
    }
}

# =============================================================================
# DOWNLOAD & AUTOMATION SERVICES
# =============================================================================

# Sonarr - TV Show Management
server {
    listen 443 ssl;
    http2 on;
    listen [::]:443 ssl;
    server_name sonarr.7gram.xyz;

    ssl_certificate /etc/nginx/ssl/fullchain.pem;
    ssl_certificate_key /etc/nginx/ssl/privkey.pem;

    # Security headers
    add_header Strict-Transport-Security "max-age=31536000; includeSubDomains" always;
    add_header X-Frame-Options "SAMEORIGIN" always;
    add_header X-Content-Type-Options "nosniff" always;

    location / {
        # Using variable for runtime DNS resolution
        set $upstream_sonarr $sullivan_sonarr_upstream;
        proxy_pass http://$upstream_sonarr;
        proxy_http_version 1.1;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;

        # WebSocket support for SignalR
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";

        proxy_read_timeout 300s;
    }
}

# Radarr - Movie Management
server {
    listen 443 ssl;
    http2 on;
    listen [::]:443 ssl;
    server_name radarr.7gram.xyz;

    ssl_certificate /etc/nginx/ssl/fullchain.pem;
    ssl_certificate_key /etc/nginx/ssl/privkey.pem;

    # Security headers
    add_header Strict-Transport-Security "max-age=31536000; includeSubDomains" always;
    add_header X-Frame-Options "SAMEORIGIN" always;
    add_header X-Content-Type-Options "nosniff" always;

    location / {
        # Using variable for runtime DNS resolution
        set $upstream_radarr $sullivan_radarr_upstream;
        proxy_pass http://$upstream_radarr;
        proxy_http_version 1.1;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;

        # WebSocket support for SignalR
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";

        proxy_read_timeout 300s;
    }
}

# Lidarr - Music Management
server {
    listen 443 ssl;
    http2 on;
    listen [::]:443 ssl;
    server_name lidarr.7gram.xyz;

    ssl_certificate /etc/nginx/ssl/fullchain.pem;
    ssl_certificate_key /etc/nginx/ssl/privkey.pem;

    # Security headers
    add_header Strict-Transport-Security "max-age=31536000; includeSubDomains" always;
    add_header X-Frame-Options "SAMEORIGIN" always;
    add_header X-Content-Type-Options "nosniff" always;

    location / {
        # Using variable for runtime DNS resolution
        set $upstream_lidarr $sullivan_lidarr_upstream;
        proxy_pass http://$upstream_lidarr;
        proxy_http_version 1.1;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;

        # WebSocket support for SignalR
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";

        proxy_read_timeout 300s;
    }
}

# Prowlarr - Indexer Manager (replaces Jackett)
server {
    listen 443 ssl;
    http2 on;
    listen [::]:443 ssl;
    server_name prowlarr.7gram.xyz;

    ssl_certificate /etc/nginx/ssl/fullchain.pem;
    ssl_certificate_key /etc/nginx/ssl/privkey.pem;

    # Security headers
    add_header Strict-Transport-Security "max-age=31536000; includeSubDomains" always;
    add_header X-Frame-Options "SAMEORIGIN" always;
    add_header X-Content-Type-Options "nosniff" always;

    location / {
        set $upstream_prowlarr $sullivan_prowlarr_upstream;
        proxy_pass http://$upstream_prowlarr;
        proxy_http_version 1.1;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;

        # WebSocket support for SignalR
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";

        proxy_read_timeout 300s;
    }
}

# Bazarr - Subtitle Management
server {
    listen 443 ssl;
    http2 on;
    listen [::]:443 ssl;
    server_name bazarr.7gram.xyz;

    ssl_certificate /etc/nginx/ssl/fullchain.pem;
    ssl_certificate_key /etc/nginx/ssl/privkey.pem;

    # Security headers
    add_header Strict-Transport-Security "max-age=31536000; includeSubDomains" always;
    add_header X-Frame-Options "SAMEORIGIN" always;
    add_header X-Content-Type-Options "nosniff" always;

    location / {
        set $upstream_bazarr $sullivan_bazarr_upstream;
        proxy_pass http://$upstream_bazarr;
        proxy_http_version 1.1;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;

        # WebSocket support for SignalR
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";

        proxy_read_timeout 300s;
    }
}

# Overseerr - Media Request Management
server {
    listen 443 ssl;
    http2 on;
    listen [::]:443 ssl;
    server_name overseerr.7gram.xyz;

    ssl_certificate /etc/nginx/ssl/fullchain.pem;
    ssl_certificate_key /etc/nginx/ssl/privkey.pem;

    # Security headers
    add_header Strict-Transport-Security "max-age=31536000; includeSubDomains" always;
    add_header X-Frame-Options "SAMEORIGIN" always;
    add_header X-Content-Type-Options "nosniff" always;

    location / {
        set $upstream_overseerr $sullivan_overseerr_upstream;
        proxy_pass http://$upstream_overseerr;
        proxy_http_version 1.1;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;

        # WebSocket support
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";

        proxy_read_timeout 300s;
    }
}

# Tdarr - Media Transcoding
server {
    listen 443 ssl;
    http2 on;
    listen [::]:443 ssl;
    server_name tdarr.7gram.xyz;

    ssl_certificate /etc/nginx/ssl/fullchain.pem;
    ssl_certificate_key /etc/nginx/ssl/privkey.pem;

    # Security headers
    add_header Strict-Transport-Security "max-age=31536000; includeSubDomains" always;
    add_header X-Frame-Options "SAMEORIGIN" always;
    add_header X-Content-Type-Options "nosniff" always;

    location / {
        set $upstream_tdarr $sullivan_tdarr_upstream;
        proxy_pass http://$upstream_tdarr;
        proxy_http_version 1.1;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;

        # WebSocket support (real-time transcode monitoring)
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";

        # Long timeout for transcoding operations
        proxy_read_timeout 86400s;
        proxy_send_timeout 86400s;
    }
}

# qBittorrent - Torrent Client
server {
    listen 443 ssl;
    http2 on;
    listen [::]:443 ssl;
    server_name qbt.7gram.xyz;

    ssl_certificate /etc/nginx/ssl/fullchain.pem;
    ssl_certificate_key /etc/nginx/ssl/privkey.pem;

    # Security headers
    add_header Strict-Transport-Security "max-age=31536000; includeSubDomains" always;
    add_header X-Frame-Options "SAMEORIGIN" always;
    add_header X-Content-Type-Options "nosniff" always;

    # Allow large torrent files
    client_max_body_size 50M;

    location / {
        # Using variable for runtime DNS resolution
        set $upstream_qbittorrent $sullivan_qbittorrent_upstream;
        proxy_pass http://$upstream_qbittorrent;
        proxy_http_version 1.1;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;

        # Required for qBittorrent WebUI
        proxy_set_header Referer "";
        proxy_set_header Origin "";

        proxy_read_timeout 300s;
    }
}

# =============================================================================
# BOOKS & MEDIA MANAGEMENT
# =============================================================================

# Calibre - eBook Management
server {
    listen 443 ssl;
    http2 on;
    listen [::]:443 ssl;
    server_name calibre.7gram.xyz;

    ssl_certificate /etc/nginx/ssl/fullchain.pem;
    ssl_certificate_key /etc/nginx/ssl/privkey.pem;

    # Security headers
    add_header Strict-Transport-Security "max-age=31536000; includeSubDomains" always;
    add_header X-Frame-Options "SAMEORIGIN" always;
    add_header X-Content-Type-Options "nosniff" always;

    # Allow large ebook uploads
    client_max_body_size 500M;

    location / {
        # Using variable for runtime DNS resolution
        set $upstream_calibre $sullivan_calibre_upstream;
        proxy_pass http://$upstream_calibre;
        proxy_http_version 1.1;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;

        # WebSocket support
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";

        proxy_read_timeout 600s;
    }
}

# YouTube-DL Material - Video Downloader
server {
    listen 443 ssl;
    http2 on;
    listen [::]:443 ssl;
    server_name yt.7gram.xyz;

    ssl_certificate /etc/nginx/ssl/fullchain.pem;
    ssl_certificate_key /etc/nginx/ssl/privkey.pem;

    # Security headers
    add_header Strict-Transport-Security "max-age=31536000; includeSubDomains" always;
    add_header X-Frame-Options "SAMEORIGIN" always;

    # Default content type for upstream responses missing Content-Type header
    default_type text/html;

    location / {
        # Using variable for runtime DNS resolution
        set $upstream_ytdl $sullivan_ytdl_upstream;
        proxy_pass http://$upstream_ytdl;
        proxy_http_version 1.1;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;

        # WebSocket support
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";

        proxy_read_timeout 3600s;
    }
}

# FileBot - Media File Organizer
server {
    listen 443 ssl;
    http2 on;
    listen [::]:443 ssl;
    server_name filebot.7gram.xyz;

    ssl_certificate /etc/nginx/ssl/fullchain.pem;
    ssl_certificate_key /etc/nginx/ssl/privkey.pem;

    # Security headers
    add_header Strict-Transport-Security "max-age=31536000; includeSubDomains" always;
    add_header X-Frame-Options "SAMEORIGIN" always;
    add_header X-Content-Type-Options "nosniff" always;

    location / {
        # Using variable for runtime DNS resolution
        set $upstream_filebot $sullivan_filebot_upstream;
        proxy_pass http://$upstream_filebot;
        proxy_http_version 1.1;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;

        # WebSocket support
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";

        proxy_read_timeout 600s;
    }
}

# =============================================================================
# UTILITY SERVICES
# =============================================================================

# Grocy - Grocery & Household Management
server {
    listen 443 ssl;
    http2 on;
    listen [::]:443 ssl;
    server_name grocy.7gram.xyz;

    ssl_certificate /etc/nginx/ssl/fullchain.pem;
    ssl_certificate_key /etc/nginx/ssl/privkey.pem;

    # Security headers
    add_header Strict-Transport-Security "max-age=31536000; includeSubDomains" always;
    add_header X-Frame-Options "SAMEORIGIN" always;
    add_header X-Content-Type-Options "nosniff" always;

    location / {
        # Using variable for runtime DNS resolution
        set $upstream_grocy $sullivan_grocy_upstream;
        proxy_pass http://$upstream_grocy;
        proxy_http_version 1.1;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;

        proxy_read_timeout 300s;
    }
}

# Mealie - Recipe Manager
server {
    listen 443 ssl;
    http2 on;
    listen [::]:443 ssl;
    server_name mealie.7gram.xyz;

    ssl_certificate /etc/nginx/ssl/fullchain.pem;
    ssl_certificate_key /etc/nginx/ssl/privkey.pem;

    # Security headers
    add_header Strict-Transport-Security "max-age=31536000; includeSubDomains" always;
    add_header X-Frame-Options "SAMEORIGIN" always;
    add_header X-Content-Type-Options "nosniff" always;

    # Allow image uploads
    client_max_body_size 50M;

    location / {
        # Using variable for runtime DNS resolution
        set $upstream_mealie $sullivan_mealie_upstream;
        proxy_pass http://$upstream_mealie;
        proxy_http_version 1.1;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;

        proxy_read_timeout 300s;
    }
}

# Wiki.js - Wiki/Documentation
server {
    listen 443 ssl;
    http2 on;
    listen [::]:443 ssl;
    server_name wiki.7gram.xyz;

    ssl_certificate /etc/nginx/ssl/fullchain.pem;
    ssl_certificate_key /etc/nginx/ssl/privkey.pem;

    # Security headers
    add_header Strict-Transport-Security "max-age=31536000; includeSubDomains" always;
    add_header X-Frame-Options "SAMEORIGIN" always;
    add_header X-Content-Type-Options "nosniff" always;

    # Allow file uploads
    client_max_body_size 100M;

    location / {
        # Using variable for runtime DNS resolution
        set $upstream_wiki $sullivan_wiki_upstream;
        proxy_pass http://$upstream_wiki;
        proxy_http_version 1.1;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;

        # WebSocket support
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";

        proxy_read_timeout 300s;
    }
}

# Duplicati - Backup Software
server {
    listen 443 ssl;
    http2 on;
    listen [::]:443 ssl;
    server_name duplicati.7gram.xyz;

    ssl_certificate /etc/nginx/ssl/fullchain.pem;
    ssl_certificate_key /etc/nginx/ssl/privkey.pem;

    # Security headers
    add_header Strict-Transport-Security "max-age=31536000; includeSubDomains" always;
    add_header X-Frame-Options "SAMEORIGIN" always;
    add_header X-Content-Type-Options "nosniff" always;

    location / {
        # Using variable for runtime DNS resolution
        set $upstream_duplicati $sullivan_duplicati_upstream;
        proxy_pass http://$upstream_duplicati;
        proxy_http_version 1.1;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;

        proxy_read_timeout 3600s;
    }
}

# Sullivan server direct access
server {
    listen 443 ssl;
    http2 on;
    listen [::]:443 ssl;
    server_name sullivan.7gram.xyz;

    ssl_certificate /etc/nginx/ssl/fullchain.pem;
    ssl_certificate_key /etc/nginx/ssl/privkey.pem;

    # Security headers
    add_header Strict-Transport-Security "max-age=31536000; includeSubDomains" always;
    add_header X-Frame-Options "SAMEORIGIN" always;
    add_header X-Content-Type-Options "nosniff" always;

    # Redirect to Emby as default media server
    location / {
        return 302 https://emby.7gram.xyz$request_uri;
    }

    # Health check
    location /health {
        access_log off;
        return 200 "Sullivan Proxy OK\n";
        add_header Content-Type text/plain;
    }
}
